# basic-file-exploit

The program provided allows you to write to a file and read what you wrote from it. Try playing around with it and see if you can break it! [program-redacted.c](./program-redacted.c).

Author: Author: Will Hong

100 Points

---
## Solution

When we take a look at the source code, we first want to see what conditions we need to meet in order to print out the flag. We can see that in theory, if entry number while reading is equal to 0, then it prints the flag.
```C
  if ((entry_number = strtol(entry, NULL, 10)) == 0) {
    puts(flag);
    fseek(stdin, 0, SEEK_END);
    exit(0);
  }
```
With that said, we run through our local binary [program](./prog) and we can see that it prints out our redacted flag!
```
Hi, welcome to my echo chamber!
Type '1' to enter a phrase into our database
Type '2' to echo a phrase in our database
Type '3' to exit the program
1
Please enter your data:
howdy
Please enter the length of your data:
1
Your entry number is: 1
Write successful, would you like to do anything else?
2
Please enter the entry number of your data:
0
[REDACTED]
```
We can very easily and manually get the flag, or we can spend a few seconds writing a script to do it for us because automation, right? You can view the exploit code [here](./exploit.py):

---
## Flag
```
picoCTF{M4K3_5UR3_70_CH3CK_Y0UR_1NPU75_68466E2F}
```